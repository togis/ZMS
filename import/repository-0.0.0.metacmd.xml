<?xml version="1.0" encoding="utf-8"?>

<list>
  <item type="dictionary">
    <dictionary>
      <item key="data"><![CDATA[## Script (Python) "manage_repository_commit"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=
##title=*** DO NOT DELETE OR MODIFY ***
##
request = container.REQUEST
RESPONSE =  request.RESPONSE
btn = request.form.get('btn')
came_from = request.get('came_from',request['HTTP_REFERER'])
if came_from.find('?') > 0:
	came_from = came_from[:came_from.find('?')]

print '<!DOCTYPE html>'
print '<html lang="en">'
print context.zmi_html_head(context,request)
print '<body class="%s">'%(' '.join(['zmi',request['lang'],context.meta_id]))
print context.zmi_body_header(context,request,options=[{'action':'#','label':'SVN-%s...'%unicode(context.getZMILangStr('BTN_COMMIT'),'utf-8')}])
print '<div id="zmi-tab">'
print context.zmi_breadcrumbs(context,request)
print '<form class="form-horizontal" method="post" enctype="multipart/form-data">'
print '<input type="hidden" name="lang" value="%s"/>'%request['lang']
print '<input type="hidden" name="came_from" value="%s"/>'%came_from
print '<legend>SVN-%s...</legend>'%unicode(context.getZMILangStr('BTN_COMMIT'),'utf-8')

# --- Execute.
# ---------------------------------
if btn==context.getZMILangStr('BTN_COMMIT'):
	success = context.commitChanges(request.get('ids',[]))
	message = [context.getZMILangStr('MSG_EXPORTED')%('<em>%s</em>'%' '.join(success))]
	request.response.redirect(context.url_append_params('manage_main',{'lang':request['lang'],'manage_tabs_message':'<br/>'.join(message)}))

# --- Cancel.
# ---------------------------------
elif btn==context.getZMILangStr('BTN_CANCEL'):
	request.response.redirect(context.url_append_params(came_from,{'lang':request['lang']}))

# --- Display initial form.
# -------------------------
else:
	print '<div class="form-group">'
	print '<label for="message" class="col-sm-2 control-label mandatory">Message</label>'
	print '<div class="col-sm-10"><input class="form-control" name="message" type="text" size="25" value=""></div>'
	print '</div><!-- .form-group -->'
	print '<div class="form-group">'
	print '<div class="controls save">'
	print '<button type="submit" name="btn" class="btn btn-primary" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_COMMIT'),'utf-8'),unicode(context.getZMILangStr('BTN_COMMIT'),'utf-8'))
	print '<button type="submit" name="btn" class="btn btn-default" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'),unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'))
	print '</div>'
	print '</div><!-- .form-group -->'
	print context.manage_main_diff(context,request)

# ---------------------------------

print '</form><!-- .form-horizontal -->'
print '<div style="clear:both;">&nbsp;</div>'
print '</div><!-- #zmi-tab -->'
print context.zmi_body_footer(context,request)
print '</body>'
print '</html>'

return printed
]]>
      </item>
      <item key="description"></item>
      <item key="execution" type="int">0</item>
      <item key="icon_clazz"><![CDATA[icon-share-alt text-success]]></item>
      <item key="id">manage_repository_commit</item>
      <item key="meta_type"><![CDATA[Script (Python)]]></item>
      <item key="meta_types" type="list">
        <list>
          <item>ZMS</item>
        </list>
      </item>
      <item key="name">BTN_COMMIT</item>
      <item key="revision">0.0.0</item>
      <item key="roles" type="list">
        <list>
          <item>ZMSAdministrator</item>
        </list>
      </item>
      <item key="title">BTN_COMMIT</item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="data"><![CDATA[## Script (Python) "manage_repository_rollback"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=
##title=*** DO NOT DELETE OR MODIFY ***
##
request = container.REQUEST
RESPONSE =  request.RESPONSE
btn = request.form.get('btn')
came_from = request.get('came_from',request['HTTP_REFERER'])
if came_from.find('?') > 0:
	came_from = came_from[:came_from.find('?')]

print '<!DOCTYPE html>'
print '<html lang="en">'
print context.zmi_html_head(context,request)
print '<body class="%s">'%(' '.join(['zmi',request['lang'],context.meta_id]))
print context.zmi_body_header(context,request,options=[{'action':'#','label':'SVN-%s...'%unicode(context.getZMILangStr('BTN_ROLLBACK'),'utf-8')}])
print '<div id="zmi-tab">'
print context.zmi_breadcrumbs(context,request)
print '<form class="form-horizontal" method="post" enctype="multipart/form-data">'
print '<input type="hidden" name="lang" value="%s"/>'%request['lang']
print '<input type="hidden" name="came_from" value="%s"/>'%came_from
print '<legend>SVN-%s...</legend>'%unicode(context.getZMILangStr('BTN_ROLLBACK'),'utf-8')

# --- Execute.
# ---------------------------------
if btn==context.getZMILangStr('BTN_ROLLBACK'):
	success = context.updateChanges(request.get('ids',[]),btn=='override')
	message = [context.getZMILangStr('MSG_IMPORTED')%('<em>%s</em>'%' '.join(success))]
	request.response.redirect(context.url_append_params('manage_main',{'lang':request['lang'],'manage_tabs_message':'<br/>'.join(message)}))

# --- Cancel.
# ---------------------------------
elif btn==context.getZMILangStr('BTN_CANCEL'):
	request.response.redirect(context.url_append_params(came_from,{'lang':request['lang']}))

# --- Display initial form.
# -------------------------
else:
	print '<div class="form-group">'
	print '<div class="controls save">'
	print '<button type="submit" name="btn" class="btn btn-primary" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_ROLLBACK'),'utf-8'),unicode(context.getZMILangStr('BTN_ROLLBACK'),'utf-8'))
	print '<button type="submit" name="btn" class="btn btn-default" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'),unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'))
	print '</div>'
	print '</div><!-- .form-group -->'

# ---------------------------------

print '</form><!-- .form-horizontal -->'
print '<div style="clear:both;">&nbsp;</div>'
print '</div><!-- #zmi-tab -->'
print context.zmi_body_footer(context,request)
print '</body>'
print '</html>'

return printed
]]>
      </item>
      <item key="description"></item>
      <item key="execution" type="int">0</item>
      <item key="icon_clazz"><![CDATA[icon-reply text-danger]]></item>
      <item key="id">manage_repository_rollback</item>
      <item key="meta_type"><![CDATA[Script (Python)]]></item>
      <item key="meta_types" type="list">
        <list>
          <item>ZMS</item>
        </list>
      </item>
      <item key="name">BTN_ROLLBACK</item>
      <item key="revision">0.0.0</item>
      <item key="roles" type="list">
        <list>
          <item>ZMSAdministrator</item>
        </list>
      </item>
      <item key="title">BTN_ROLLBACK</item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="data"><![CDATA[## Script (Python) "manage_repository_config"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=
##title=*** DO NOT DELETE OR MODIFY ***
##
request = container.REQUEST
RESPONSE =  request.RESPONSE
btn = request.form.get('btn')
came_from = request.get('came_from',request['HTTP_REFERER'])
if came_from.find('?') > 0:
	came_from = came_from[:came_from.find('?')]

print '<!DOCTYPE html>'
print '<html lang="en">'
print context.zmi_html_head(context,request)
print '<body class="%s">'%(' '.join(['zmi',request['lang'],context.meta_id]))
print context.zmi_body_header(context,request,options=[{'action':'#','label':'SVN-%s...'%unicode(context.getZMILangStr('TAB_CONFIGURATION'),'utf-8')}])
print '<div id="zmi-tab">'
print context.zmi_breadcrumbs(context,request)
print '<form class="form-horizontal" method="post" enctype="multipart/form-data">'
print '<input type="hidden" name="lang" value="%s"/>'%request['lang']
print '<input type="hidden" name="came_from" value="%s"/>'%came_from
print '<legend>SVN-%s...</legend>'%unicode(context.getZMILangStr('TAB_CONFIGURATION'),'utf-8')

# --- Execute.
# ---------------------------------
if btn==context.getZMILangStr('BTN_CHANGE'):
	message = []
	context.setConfProperty('ZMSRepository.svn.server.url',request['url'])
	context.setConfProperty('ZMSRepository.svn.server.userid',request['userid'])
	context.setConfProperty('ZMSRepository.svn.server.password',request['password'])
	message.append(context.getZMILangStr('MSG_CHANGED'))
	request.response.redirect(context.url_append_params('manage_main',{'lang':request['lang'],'manage_tabs_message':'<br/>'.join(message)}))

# --- Cancel.
# ---------------------------------
elif btn==context.getZMILangStr('BTN_CANCEL'):
	request.response.redirect(context.url_append_params(came_from,{'lang':request['lang']}))

# --- Display initial form.
# -------------------------
else:
	print '<div class="form-group">'
	print '<label for="url" class="col-sm-3 control-label mandatory">Server</label>'
	print '<div class="col-sm-9"><input class="form-control" name="url" type="text" size="25" value="%s"></div>'%context.getConfProperty('ZMSRepository.svn.server.url','https://zmslabs.org/svn/demo/myzmsx')
	print '</div><!-- .form-group -->'
	print '<div class="form-group">'
	print '<label for="userid" class="col-sm-3 control-label mandatory">User-ID</label>'
	print '<div class="col-sm-9"><input class="form-control" name="userid" type="text" size="25" value="%s"></div>'%context.getConfProperty('ZMSRepository.svn.server.userid','zmsdev')
	print '</div><!-- .form-group -->'
	print '<div class="form-group">'
	print '<label for="password" class="col-sm-3 control-label mandatory">Password</label>'
	print '<div class="col-sm-9"><input class="form-control" name="password" type="password" size="25" value="%s"></div>'%context.getConfProperty('ZMSRepository.svn.server.password','********')
	print '</div><!-- .form-group -->'
	print '<div class="form-group">'
	print '<div class="controls save">'
	print '<button type="submit" name="btn" class="btn btn-primary" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_CHANGE'),'utf-8'),unicode(context.getZMILangStr('BTN_CHANGE'),'utf-8'))
	print '<button type="submit" name="btn" class="btn btn-default" value="%s">%s</button>'%(unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'),unicode(context.getZMILangStr('BTN_CANCEL'),'utf-8'))
	print '</div>'
	print '</div><!-- .form-group -->'

# ---------------------------------

print '</form><!-- .form-horizontal -->'
print '<div style="clear:both;">&nbsp;</div>'
print '</div><!-- #zmi-tab -->'
print context.zmi_body_footer(context,request)
print '</body>'
print '</html>'

return printed
]]>
      </item>
      <item key="description"></item>
      <item key="execution" type="int">0</item>
      <item key="icon_clazz">icon-cogs</item>
      <item key="id">manage_repository_config</item>
      <item key="meta_type"><![CDATA[Script (Python)]]></item>
      <item key="meta_types" type="list">
        <list>
          <item>ZMS</item>
        </list>
      </item>
      <item key="name">TAB_CONFIGURATION</item>
      <item key="revision">0.0.0</item>
      <item key="roles" type="list">
        <list>
          <item>ZMSAdministrator</item>
        </list>
      </item>
      <item key="title">TAB_CONFIGURATION</item>
    </dictionary>
  </item>
</list>